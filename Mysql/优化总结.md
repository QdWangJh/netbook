

建立索引,常用组合字段建立组合索引

### 求count

在求行数时

```sql
count(*)=count(1)<count(主键字段)<count(字段)
```



### in

**将含In的范围查询，放到where条件的最后，防止失效。**

在查询条件有 in 时,索引会失效

\1. in()适合B表比A表数据小的情况

\2. exists()适合B表比A表数据大的情况



### in和exists的区别

1、适用表的类型不同。

in是子查询为驱动表，外面的表为被驱动表，故适用于子查询结果集小而外面的表结果集大的情况。

exists是外面的表位驱动表，子查询里面的表为被驱动表，故适用于外面的表结果集小而子查询结果集大的情况。

2、子查询关联不同。

exists一般都是关联子查询。对于关联子查询，必须先执行外层查询，接着对所有通过过滤条件的记录，执行内层查询。外层查询和内层查询相互依赖，因为外层查询会把数据传递给内层查询。

in则一般都是非关联子查询，非关联子查询则必须先完成内层查询之后，外层查询才能介入。

3、执行次数不同。

IN 语句：只执行一次，确定给定的值是否与子查询或列表中的值相匹配。in在查询的时候，首先查询子查询的表，然后将内表和外表做一个笛卡尔积，然后按照条件进行筛选。所以相对内表比较小的时候，in的速度较快。

EXISTS语句：执行次数根据表的长度而定。指定一个子查询，检测行的存在。遍历循环外表，然后看外表中的记录有没有和内表的数据一样的。匹配上就将结果放入结果集中。

### 索引

- 不要在索引上进行任何操作(计算、函数、类型转换)，否则索引失效
- **索引不能使用不等于（!= <>）或is null (is not null)，否则自身以及右侧所有全部失效(针对大多数情况)。复合索引中如果有>，则自身和右侧索引全部失效。**
- **like尽量以“常量”开头，不要以’%'开头，否则索引失效**
- **尽量不要使用类型转换（显示、隐式），否则索引失效**
- **尽量不要使用or，否则索引失效**
